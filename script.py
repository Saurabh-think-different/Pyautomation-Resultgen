from selenium import webdriver
from read_excel import read_excel, write_excel
import pandas as pd
# from selenium.webdriver.common.keys import Keys

values = read_excel()
driver = webdriver.Chrome('C:\webdrivers\chromedriver.exe')
url = 'https://buofc.inhawk.com/examresults/'
driver.get(url)

def send_data():
    for regno in values:
        input = driver.find_element_by_xpath('//*[@id="ContentPlaceHolder1_txtSearch"]')
        checkResultBtn = driver.find_element_by_xpath('//*[@id="ContentPlaceHolder1_btnSearch"]')
        input.send_keys(regno)
        checkResultBtn.click()
        std_marks = []

        for i in range(2, 18):
            std_marks.append(driver.find_element_by_xpath(f'//*[@id="ContentPlaceHolder1_grdexamresults"]/tbody/tr[{i}]/td[5]').text)

        dict1 = {
            'regno': regno,
            'std_marks': std_marks,
        }
        marks_list.append(dict1)
        clearResultBtn = driver.find_element_by_xpath('//*[@id="ContentPlaceHolder1_btnclear"]')
        
        clearResultBtn.click()

# df = pd.DataFrame(marks_list)

if __name__ == '__main__':   
    marks_list = []
    send_data()
    write_excel(marks_list)
    pass 


#Output is 
# marks_list = [{'regno': '18GAEC9001', 'std_marks': ['25', '48', '35', '47', '37', '48', '36', '46', '30', '43', '43', '50', '35', '49', '24', '48']}, {'regno': '18GAEC9007', 'std_marks': ['23', '48', '27', '46', '45', '47', '35', '42', '31', '47', '42', '35', '31', '43', '22', '45']}, {'regno': '18GAEC9003', 'std_marks': ['25', '50', '32', '48', '46', '46', '34', '42', '30', '50', '42', '48', '34', '36', '22', '47']}, {'regno': '18GAEC9004', 'std_marks': ['25', '50', '29', '44', '42', '48', '37', '44', '39', '50', '46', '50', '29', '48', '29', '47']}, {'regno': '18GAEC9005', 'std_marks': ['30', '48', '27', '42', '42', '45', '35', '44', '33', '43', '35', '40', '29', '46', '36', '43']}, {'regno': '18GAEC9006', 'std_marks': ['33', '48', '33', '46', '31', '48', '28', '42', '30', '46', '40', '48', '35', '38', '35', '47']}, {'regno': '18GAEC9008', 'std_marks': ['21', '36', '20', '41', '34', '39', '5', '42', '11', '43', 'ABSENT', '35', '20', '40', '21', '37']}, {'regno': '18GAEC9009', 'std_marks': ['29', '48', '25', '47', '46', '49', '32', '46', '35', '45', '45', '50', '30', '47', '25', '45']}, {'regno': '19GACSE077', 'std_marks': ['28', '48', '24', '46', '47', '46', '34', '46', '29', '40', '45', '48', '23', '43', '35', '46']}, {'regno': '18GAEC9013', 'std_marks': ['32', '44', '29', '45', '43', '46', '30', '44', '37', '35', '48', '46', '32', '46', '21', '45']}, {'regno': '18GAEC9015', 'std_marks': ['25', '50', '29', '41', '44', '46', '32', '44', '28', '42', '35', '45', '21', '38', '30', '46']}, {'regno': '19GACSE078', 'std_marks': ['27', '48', '29', '46', '41', '45', '37', '46', '32', '48', '40', '48', '27', '41', '34', '47']}, {'regno': '18GAEC9016', 'std_marks': ['34', '50', '32', '46', '48', '49', '31', '44', '41', '35', '44', '48', '29', '45', '30', '44']}, {'regno': '18GAEC9018', 'std_marks': ['28', '46', '31', '46', '46', '48', '31', '40', '35', '42', '44', '48', '24', '40', '26', '45']}, {'regno': '18GAEC9019', 'std_marks': ['35', '48', '34', '46', '49', '47', '37', '40', '42', '45', '44', '50', '26', '45', '29', '48']}, {'regno': '18GAEC9020', 'std_marks': ['21', '48', '30', '45', '40', '47', '29', '46', '28', '40', '34', '48', '23', '45', '23', '46']}, {'regno': '18GAEC9022', 'std_marks': ['24', '48', '26', '47', '46', '47', '38', '40', '40', '42', '46', '40', '21', '44', '23', '45']}, {'regno': '18GAEC9023', 'std_marks': ['29', '50', '32', '47', '42', '47', '36', '46', '34', '40', '48', '46', '25', '38', '27', '46']}, {'regno': '18GAEC9025', 'std_marks': ['25', '50', '33', '48', '47', '48', '38', '44', '39', '42', '45', '48', '24', '45', '26', '45']}, {'regno': '18GAEC9026', 'std_marks': ['31', '48', '34', '48', '29', '48', '39', '46', '34', '44', '48', '46', '25', '42', '35', '42']}, {'regno': '18GAEC9027', 'std_marks': ['26', '44', '28', '46', '34', '35', '35', '40', '32', '40', '47', '35', '25', '41', '26', '38']}, {'regno': '18GAEC9028', 'std_marks': ['28', '48', '28', '48', '44', '46', '39', '44', '35', '45', '44', '48', '26', '42', '30', '45']}, {'regno': '18GAEC9030', 'std_marks': ['29', '50', '33', '46', '42', '47', '39', '46', '35', '44', '47', '50', '25', '43', '30', '47']}, {'regno': '18GAEC9031', 'std_marks': ['28', '48', '27', '46', '42', '49', '26', '44', '31', '48', '44', '40', '25', '37', '31', '44']}, {'regno': '18GAEC9032', 'std_marks': ['23', '40', '28', '44', '44', '39', '33', '42', '23', '40', '33', '35', '21', '44', '28', '42']}, {'regno': '18GAEC9033', 'std_marks': ['31', '40', '28', '39', '45', '36', '29', '40', '31', '25', '47', '35', '32', '24', '31', '40']}, {'regno': '18GAEC9034', 'std_marks': ['26', '40', '28', '38', '45', '36', '26', '46', '21', '41', '33', '25', '25', '44', '25', '37']}, {'regno': '18GAEC9035', 'std_marks': ['26', '48', '34', '41', '44', '49', '34', '42', '35', '50', '45', '46', '26', '42', '34', '45']}, {'regno': '18GAEC9036', 'std_marks': ['28', '50', '27', '45', '38', '45', '31', '44', '34', '44', '44', '46', '26', '45', '31', '45']}, {'regno': '18GAEM9050', 'std_marks': ['33', '50', '36', '49', '46', '48', '41', '46', '38', '45', '45', '50', '32', '46', '35', '48']}, {'regno': '18GAEC9037', 'std_marks': ['27', '48', '28', '45', '46', '42', '33', '30', '31', '37', '43', '25', '20', '45', '27', '43']}, {'regno': '18GAEC9039', 'std_marks': ['30', '46', '38', '42', '45', '47', '36', '42', '40', '40', '44', '46', '33', '41', '40', '45']}, {'regno': '18GAEC9040', 'std_marks': ['29', '40', '34', '47', '44', '48', '31', '48', '36', '38', '45', '40', '28', '42', '34', '44']}, {'regno': '18GAEC9043', 'std_marks': ['34', '50', '36', '49', '46', '48', '40', '44', '41', '40', '45', '48', '32', '46', '36', '48']}, {'regno': '18GAEC9044', 'std_marks': ['27', '50', '31', '47', '38', '47', '32', '46', '30', '41', '45', '46', '34', '48', '36', '45']}, {'regno': '18GAEC9045', 'std_marks': ['27', '50', '31', '46', '46', '47', '38', '42', '30', '47', '43', '48', '26', '46', '29', '46']}, {'regno': '18GAEC9046', 'std_marks': ['32', '50', '36', '45', '48', '47', '32', '48', '41', '41', '43', '50', '37', '42', '41', '44']}, {'regno': '18GAEC9047', 'std_marks': ['35', '50', '36', '46', '45', '49', '39', '44', '36', '48', '42', '48', '34', '44', '42', '48']}, {'regno': '18GAEC9049', 'std_marks': ['25', '42', '29', '46', '45', '47', '36', '44', '28', '40', '41', '48', '25', '47', '28', '48']}, {'regno': '18GAEC9050', 'std_marks': ['26', '50', '26', '40', '39', '41', '31', '44', '21', '40', '41', '48', '21', '44', '29', '41']}, {'regno': '18GAEC9052', 'std_marks': ['26', '48', '27', '45', '44', '45', '34', '42', '21', '40', '41', '50', '20', '44', '34', '46']}, {'regno': '18GAEC9053', 'std_marks': ['20', '44', '22', '39', '44', '40', '23', '34', '21', '40', '41', '46', '20', '39', '22', '43']}, {'regno': '18GAEC9055', 'std_marks': ['29', '48', '30', '47', '48', '44', '35', '42', '31', '40', '42', '50', '30', '38', '39', '46']}, {'regno': '18GAEC9056', 'std_marks': ['24', '48', '30', '45', '42', '47', '37', '42', '31', '40', '41', '48', '26', '45', '33', '42']}, {'regno': '18GAEC9057', 'std_marks': ['26', '48', '23', '44', '37', '46', '32', '44', '28', '40', '44', '48', '24', '40', '34', '46']}, {'regno': '19GACSE079', 'std_marks': ['29', '48', '28', '47', '47', '47', '36', '42', '32', '45', '46', '46', '26', '44', '40', '45']}, {'regno': '18GAEC9058', 'std_marks': ['22', '42', '24', '43', '42', '48', '33', '44', '28', '44', '42', '46', '27', '38', '42', '44']}, {'regno': '19GACSE080', 'std_marks': ['33', '48', '31', '44', '41', '40', '36', '46', '29', '45', '45', '48', '26', '40', '29', '41']}, {'regno': '19GACSE081', 'std_marks': ['30', '50', '30', '44', '48', '48', '33', '46', '35', '46', '46', '48', '27', '46', '36', '45']}, {'regno': '18GAEC9061', 'std_marks': ['29', '48', '32', '47', '42', '47', '30', '42', '29', '40', '45', '48', '29', '48', '27', '47']}, {'regno': '18GAEC9062', 'std_marks': ['33', '48', '34', '46', '44', '47', '36', '44', '34', '42', '45', '48', '36', '50', '33', '47']}, {'regno': '18GAEC9063', 'std_marks': ['26', '42', '20', '42', 'ABSENT', '47', '30', '36', '28', '35', '30', '47', '24', '39', '34', '41']}, {'regno': '19GACSE082', 'std_marks': ['22', '46', '26', '48', '42', '47', '33', '40', '26', '44', '43', '48', '25', '48', '28', '42']}, {'regno': '18GAEC9064', 'std_marks': ['32', '48', '29', '49', '48', '49', '34', '48', '36', '47', '45', '48', '36', '46', '41', '48']}, {'regno': '18GAEM9081', 'std_marks': ['33', '50', '36', '49', '47', '48', '37', '48', '34', '47', '48', '49', '30', '44', '42', '49']}, {'regno': '18GAEE7062', 'std_marks': ['32', '50', '37', '48', '46', '48', '40', '48', '37', '43', '46', '48', '26', '42', '39', '46']}, {'regno': '18GAEC9065', 'std_marks': ['20', '48', '22', '43', '41', '35', '24', '40', '27', '38', '41', '45', '20', '43', '33', '46']}, {'regno': '18GAEC9066', 'std_marks': ['28', '50', '22', '44', '44', '47', '36', '42', '30', '38', '48', '48', '28', '45', '38', '44']}, {'regno': '18GAEC9068', 'std_marks': ['36', '48', '33', '47', '47', '48', '36', '44', '34', '43', '46', '48', '32', '42', '30', '47']}, {'regno': '18GAEM9085', 'std_marks': ['29', '48', '34', '47', '47', '49', '34', '46', '35', '42', '46', '49', '24', '44', '30', '46']}, {'regno': '18GAEC9069', 'std_marks': ['33', '42', '30', '42', '46', '48', '36', '34', '26', '40', '46', '46', '22', '42', '32', '44']}, {'regno': '18GAEC9070', 'std_marks': ['31', '50', '28', '47', '47', '47', '41', '46', '33', '45', '45', '48', '27', '40', '38', '47']}, {'regno': '18GAEC9071', 'std_marks': ['25', '48', '34', '44', '47', '48', '37', '44', '32', '40', '45', '48', '27', '40', '34', '47']}, {'regno': '19GACSE083', 'std_marks': ['21', '44', '25', '43', '41', '38', '29', '44', '23', '40', '38', '42', '13', '29', '34', '45']}, {'regno': '18GAEC9072', 'std_marks': ['27', '48', '29', '46', '48', '48', '31', '44', '30', '40', '44', '46', '25', '49', '35', '46']}, {'regno': '18GAEC9073', 'std_marks': ['34', '50', '38', '45', '46', '48', '37', '46', '32', '42', '46', '48', '28', '46', '38', '47']}, {'regno': '18GAEC9074', 'std_marks': ['32', '48', '32', '48', '47', '49', '27', '42', '30', '43', '47', '48', '29', '46', '39', '47']}, {'regno': '18GAEC9075', 'std_marks': ['26', '50', '32', '42', '47', '48', '26', '38', '29', '40', '42', '42', '23', '44', '36', '48']}, {'regno': '18GAEC9076', 'std_marks': ['31', '40', '31', '46', '40', '48', '31', '42', '29', '40', '46', '44', '28', '39', '35', '46']}, {'regno': '18GAEC9077', 'std_marks': ['28', '50', '31', '46', '47', '44', '29', '44', '35', '45', '46', '45', '30', '44', '35', '48']}, {'regno': '18GAEC9079', 'std_marks': ['31', '50', '31', '43', '40', '47', '37', '46', '33', '35', '44', '46', '25', '42', '35', '46']}, {'regno': '18GAEC9042', 'std_marks': ['23', '40', '27', '47', '46', '46', '29', '44', '39', '40', '46', '48', '27', '43', '30', '46']}, {'regno': '18GAEC9067', 'std_marks': ['24', '50', '20', '47', '41', '47', '28', '46', '25', '44', '45', '48', '20', '45', '26', '45']}, {'regno': '18GAEC9059', 'std_marks': ['28', '48', '24', '41', '37', '47', '24', '36', '26', '30', '46', '48', '28', '35', '27', '42']}, {'regno': '18GAEC9014', 'std_marks': ['25', '44', '28', '40', '44', '38', '32', '36', '33', '40', '40', '42', '26', '47', '27', '43']}, {'regno': '18GAEC9051', 'std_marks': ['29', '48', '27', '46', '47', '43', '41', '44', '25', '40', '41', '46', '16', '45', '38', '46']}, {'regno': '18GAEC9029', 'std_marks': ['25', '48', '28', '44', '34', '48', '31', '42', '25', '40', '30', '40', '20', '43', '30', '40']}, {'regno': '18GAEC9078', 'std_marks': ['22', '38', '20', '44', '39', '47', '25', '44', '28', '40', '26', '42', '20', '41', '31', '44']}, {'regno': '18GAEC9017', 'std_marks': ['21', '40', '25', '46', '44', '42', '25', '36', '25', '41', '41', '48', '22', '44', '25', '42']}, {'regno': '18GAEC9054', 'std_marks': ['30', '48', '28', '41', '28', '41', '33', '42', '26', '40', '43', '48', '25', '43', '35', '42']}, {'regno': '18GAEC9060', 'std_marks': ['25', '40', '24', '38', '40', '35', '38', '44', '25', '25', '42', '48', '20', '42', '26', '38']}]

